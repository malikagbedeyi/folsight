import React, { useEffect, useState } from 'react'
import 'bootstrap/dist/css/bootstrap.min.css';
import { useNavigate } from 'react-router-dom';
import '../../../../assets/scss/Dashboard/Compl.ai/DashFramework/exportframework.scss'
import img1 from  '../../../../assets/Images/Dashboard/csv.png'
import { saveAs } from "file-saver";
import * as XLSX from "xlsx";
import jsPDF from "jspdf";
import "jspdf-autotable";  

import { tableData } from './frameworkTable';
const ExportFramework = ({proceed,setProceed,data }) => {

  const exportCSV = () => {
    const csvContent = [
      ["ID", "Title", "Description","Owner","Owner","Map Control","Map Risk","Map Framework","Time","Date","Status"], // Headers
      ...data.map((item) => [item.id, item.title, item.description,item.Owner,item.ownerName,item.mapRisk,item.mapControl,item.mapRisk,item.mapFramework,item.time,item.date,item.status,]), // Data rows
    ]
      .map((row) => row.join(","))
      .join("\n");

    const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
    saveAs(blob, "compl-data.csv");
  };
  const exportExcel = () => {
    const ws = XLSX.utils.json_to_sheet(tableData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
    const wbout = XLSX.write(wb, { bookType: "xlsx", type: "binary" });
    const blob = new Blob([s2ab(wbout)], { type: "application/octet-stream" });
    saveAs(blob, "compl-data.xlsx");
  };
  
  const s2ab = (s) => {
    const buf = new ArrayBuffer(s.length);
    const view = new Uint8Array(buf);
    for (let i = 0; i < s.length; i++) {
      view[i] = s.charCodeAt(i) & 0xff;
    }
    return buf;
  };
  const exportPDF = () => {
    const doc = new jsPDF();
    console.log(doc.autoTable);
    doc.text("Exported Data", 10, 10);
    doc.autoTable({
      head: [["ID",
         "Title",
         "Description",
        "Owner",
        "Owner",
        "Map Control",
        "Map Risk",
        "Map Framework",
        "Time",
        "Date",
        "Status"]],
      body: tableData.map((item) => 
        [item.id, 
        item.title,
         item.description,
        item.owner,
        item.ownerName,
        item.mapControl,
        item.mapRisk,
        item.mapFramework,
        item.time,
        item.date,
        item.status,]),
    });
    doc.save("compl-data.pdf");
  };
  return (
<div  className={proceed ? "export-container" : "d-none"}>
        <div className="export-content">
        <div onClick={() => setProceed(false)} className="delete-box">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.5297 17.4707C18.8227 17.7637 18.8227 18.2388 18.5297 18.5318C18.3837 18.6778 18.1917 18.7517 17.9997 18.7517C17.8077 18.7517 17.6158 18.6788 17.4698 18.5318L11.9997 13.0617L6.52975 18.5318C6.38375 18.6778 6.19175 18.7517 5.99975 18.7517C5.80775 18.7517 5.61575 18.6788 5.46975 18.5318C5.17675 18.2388 5.17675 17.7637 5.46975 17.4707L10.9398 12.0008L5.46975 6.53079C5.17675 6.23779 5.17675 5.76275 5.46975 5.46975C5.76275 5.17675 6.23775 5.17675 6.53075 5.46975L12.0008 10.9398L17.4707 5.46975C17.7637 5.17675 18.2387 5.17675 18.5317 5.46975C18.8247 5.76275 18.8247 6.23779 18.5317 6.53079L13.0617 12.0008L18.5297 17.4707Z" fill="#E21D12"/></svg>
          </div>
          <div className="export-proceeed-wrapper">
            <div className="export-proceeed-content">
              <h4>Export File</h4>
              <span>Select either of the file format to export</span>
              <div className="export-proceed">
                <div onClick={exportCSV} className="export-content">
                  <img src={img1} alt="" />
                {/* <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.5741 3.33563H12.2428V1.84375L1.83594 3.45V17.5294L12.2428 19.3219V17.1106H18.5741C18.7658 17.1203 18.9536 17.0537 19.0964 16.9254C19.2391 16.797 19.3253 16.6173 19.3359 16.4256V4.02C19.3251 3.82841 19.2389 3.6489 19.0962 3.52066C18.9534 3.39243 18.7657 3.32591 18.5741 3.33563ZM18.6741 16.5394H12.2216L12.2109 15.3588H13.7653V13.9838H12.1991L12.1916 13.1713H13.7653V11.7963H12.1797L12.1722 10.9838H13.7653V9.60875H12.1672V8.79625H13.7653V7.42125H12.1672V6.60875H13.7653V5.23375H12.1672V3.98375H18.6741V16.5394Z" fill="#20744A"/><path d="M14.6406 5.23438H17.3425V6.60937H14.6406V5.23438ZM14.6406 7.4225H17.3425V8.7975H14.6406V7.4225ZM14.6406 9.61062H17.3425V10.9856H14.6406V9.61062ZM14.6406 11.7987H17.3425V13.1737H14.6406V11.7987ZM14.6406 13.9869H17.3425V15.3619H14.6406V13.9869Z" fill="#20744A"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5525 7.25719L5.89375 7.18031L6.73688 9.49844L7.73313 7.08469L9.07438 7.00781L7.44563 10.2991L9.07438 13.5984L7.65625 13.5028L6.69875 10.9878L5.74063 13.4072L4.4375 13.2922L5.95125 10.3778L4.5525 7.25719Z" fill="white"/></svg> */}
                  <a >CSV File</a>
                </div>
                <div onClick={exportExcel} className="export-content">
                <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.5741 3.33563H12.2428V1.84375L1.83594 3.45V17.5294L12.2428 19.3219V17.1106H18.5741C18.7658 17.1203 18.9536 17.0537 19.0964 16.9254C19.2391 16.797 19.3253 16.6173 19.3359 16.4256V4.02C19.3251 3.82841 19.2389 3.6489 19.0962 3.52066C18.9534 3.39243 18.7657 3.32591 18.5741 3.33563ZM18.6741 16.5394H12.2216L12.2109 15.3588H13.7653V13.9838H12.1991L12.1916 13.1713H13.7653V11.7963H12.1797L12.1722 10.9838H13.7653V9.60875H12.1672V8.79625H13.7653V7.42125H12.1672V6.60875H13.7653V5.23375H12.1672V3.98375H18.6741V16.5394Z" fill="#20744A"/><path d="M14.6406 5.23438H17.3425V6.60937H14.6406V5.23438ZM14.6406 7.4225H17.3425V8.7975H14.6406V7.4225ZM14.6406 9.61062H17.3425V10.9856H14.6406V9.61062ZM14.6406 11.7987H17.3425V13.1737H14.6406V11.7987ZM14.6406 13.9869H17.3425V15.3619H14.6406V13.9869Z" fill="#20744A"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5525 7.25719L5.89375 7.18031L6.73688 9.49844L7.73313 7.08469L9.07438 7.00781L7.44563 10.2991L9.07438 13.5984L7.65625 13.5028L6.69875 10.9878L5.74063 13.4072L4.4375 13.2922L5.95125 10.3778L4.5525 7.25719Z" fill="white"/></svg>
                  <a >EXCEL File</a>
                </div>
                <div  onClick={exportPDF} className="export-content">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.072 1.55469L22.245 5.90469V22.4467H6.65625V22.5007H22.2983V5.95944L18.072 1.55469Z" fill="#909090"/><path d="M18.0266 1.5H6.60938V22.446H22.2514V5.90475L18.0266 1.5Z" fill="#F4F4F4"/><path d="M6.48781 2.625H1.69531V7.74525H16.7703V2.625H6.48781Z" fill="#7A7B7C"/><path d="M16.8546 7.65525H1.79688V2.53125H16.8546V7.65525Z" fill="#DD2025"/><path d="M6.79275 3.40198H5.8125V7.00198H6.5835V5.78773L6.75375 5.79748C6.91918 5.79463 7.08305 5.765 7.239 5.70973C7.37573 5.6627 7.50151 5.58846 7.60875 5.49148C7.71787 5.3991 7.80391 5.2825 7.86 5.15098C7.93522 4.93235 7.96209 4.70001 7.93875 4.46998C7.93407 4.30566 7.90526 4.14292 7.85325 3.98698C7.80591 3.87441 7.73564 3.77293 7.64693 3.689C7.55823 3.60507 7.45302 3.54053 7.338 3.49948C7.23856 3.46348 7.13581 3.43735 7.03125 3.42148C6.95207 3.40926 6.87211 3.40275 6.792 3.40198M6.65025 5.12248H6.5835V4.01248H6.72825C6.79213 4.00787 6.85624 4.01768 6.91582 4.04118C6.97541 4.06467 7.02895 4.10126 7.0725 4.14823C7.16274 4.26899 7.21095 4.41598 7.20975 4.56673C7.20975 4.75123 7.20975 4.91848 7.04325 5.03623C6.9233 5.1022 6.78677 5.13266 6.65025 5.12248ZM9.4035 3.39223C9.32025 3.39223 9.23925 3.39823 9.18225 3.40048L9.00375 3.40498H8.41875V7.00498H9.10725C9.37037 7.01219 9.63234 6.9676 9.87825 6.87373C10.0762 6.79522 10.2515 6.66867 10.3882 6.50548C10.5213 6.34082 10.6167 6.14911 10.668 5.94373C10.7269 5.71113 10.7557 5.47192 10.7535 5.23198C10.768 4.9486 10.7461 4.66452 10.6883 4.38673C10.6333 4.18225 10.5305 3.9938 10.3882 3.83698C10.2766 3.71035 10.14 3.60821 9.987 3.53698C9.85559 3.47617 9.71735 3.43135 9.57525 3.40348C9.51874 3.39415 9.46152 3.38988 9.40425 3.39073M9.26775 6.34348H9.19275V4.04548H9.2025C9.35712 4.02769 9.51356 4.05559 9.6525 4.12573C9.75425 4.20698 9.83715 4.30933 9.8955 4.42573C9.95847 4.54823 9.99476 4.68268 10.002 4.82023C10.0088 4.98523 10.002 5.12023 10.002 5.23198C10.0051 5.36071 9.99677 5.48946 9.97725 5.61673C9.95413 5.7474 9.9114 5.87383 9.8505 5.99173C9.78157 6.10135 9.68843 6.19371 9.57825 6.26173C9.48572 6.32158 9.37614 6.3495 9.26625 6.34123M13.0763 3.40498H11.2537V7.00498H12.0247V5.57698H12.9997V4.90798H12.0247V4.07398H13.0747V3.40498" fill="#464648"/><path d="M16.3326 15.1882C16.3326 15.1882 18.7236 14.7547 18.7236 15.5715C18.7236 16.3882 17.2423 16.056 16.3326 15.1882ZM14.5648 15.2505C14.185 15.3344 13.8147 15.4573 13.4601 15.6172L13.7601 14.9422C14.0601 14.2672 14.3713 13.347 14.3713 13.347C14.7293 13.9495 15.1458 14.5152 15.6148 15.036C15.2612 15.0887 14.9106 15.1608 14.5648 15.252V15.2505ZM13.6183 10.3755C13.6183 9.66371 13.8486 9.46946 14.0278 9.46946C14.2071 9.46946 14.4088 9.55571 14.4156 10.1737C14.3572 10.7951 14.2271 11.4077 14.0278 11.9992C13.7549 11.5026 13.6137 10.9444 13.6176 10.3777L13.6183 10.3755ZM10.1316 18.2625C9.39809 17.8237 11.6698 16.473 12.0816 16.4295C12.0793 16.4302 10.8996 18.7215 10.1316 18.2625ZM19.4218 15.6682C19.4143 15.5932 19.3468 14.763 17.8693 14.7982C17.2535 14.7883 16.6379 14.8317 16.0296 14.928C15.4403 14.3343 14.9328 13.6646 14.5206 12.9367C14.7803 12.1863 14.9375 11.4042 14.9878 10.6117C14.9661 9.71171 14.7508 9.19571 14.0608 9.20321C13.3708 9.21071 13.2703 9.81446 13.3611 10.713C13.45 11.3167 13.6177 11.9063 13.8598 12.4665C13.8598 12.4665 13.5411 13.4587 13.1196 14.4457C12.6981 15.4327 12.4101 15.9502 12.4101 15.9502C11.6771 16.1888 10.9871 16.5433 10.3663 17.0002C9.74834 17.5755 9.49709 18.0172 9.82259 18.459C10.1031 18.84 11.0848 18.9262 11.9623 17.7765C12.4286 17.1826 12.8545 16.5582 13.2373 15.9075C13.2373 15.9075 14.5753 15.5407 14.9916 15.4402C15.4078 15.3397 15.9111 15.2602 15.9111 15.2602C15.9111 15.2602 17.1328 16.4895 18.3111 16.446C19.4893 16.4025 19.4323 15.7417 19.4248 15.6697" fill="#DD2025"/><path d="M17.9688 1.55469V5.95944H22.1935L17.9688 1.55469Z" fill="#909090"/><path d="M18.0234 1.5V5.90475H22.2482L18.0234 1.5Z" fill="#F4F4F4"/><path d="M6.73025 3.33948H5.75V6.93948H6.524V5.72598L6.695 5.73573C6.86043 5.73288 7.0243 5.70325 7.18025 5.64798C7.31697 5.60094 7.44275 5.52669 7.55 5.42973C7.65831 5.3371 7.74356 5.22052 7.799 5.08923C7.87422 4.8706 7.90109 4.63826 7.87775 4.40823C7.87307 4.24391 7.84426 4.08117 7.79225 3.92523C7.74491 3.81266 7.67464 3.71118 7.58593 3.62725C7.49723 3.54332 7.39202 3.47878 7.277 3.43773C7.1771 3.40138 7.07385 3.375 6.96875 3.35898C6.88957 3.34676 6.80961 3.34025 6.7295 3.33948M6.58775 5.05998H6.521V3.94998H6.6665C6.73039 3.94537 6.79449 3.95518 6.85407 3.97868C6.91366 4.00218 6.9672 4.03876 7.01075 4.08573C7.10099 4.20649 7.1492 4.35348 7.148 4.50423C7.148 4.68873 7.148 4.85598 6.9815 4.97373C6.86155 5.0397 6.72502 5.06941 6.5885 5.05923M9.341 3.32973C9.25775 3.32973 9.17675 3.33573 9.11975 3.33798L8.9435 3.34248H8.3585V6.94248H9.047C9.31012 6.94969 9.57209 6.9051 9.818 6.81123C10.0159 6.73272 10.1912 6.60617 10.328 6.44298C10.461 6.27832 10.5565 6.08661 10.6077 5.88123C10.6667 5.64863 10.6954 5.40942 10.6932 5.16948C10.7078 4.8861 10.6859 4.60202 10.628 4.32423C10.5731 4.11975 10.4702 3.9313 10.328 3.77448C10.2164 3.64785 10.0798 3.54571 9.92675 3.47448C9.79534 3.41367 9.6571 3.36885 9.515 3.34098C9.45849 3.33165 9.40127 3.32738 9.344 3.32823M9.2075 6.28098H9.1325V3.98298H9.14225C9.29687 3.96519 9.45331 3.99309 9.59225 4.06323C9.694 4.14448 9.7769 4.24683 9.83525 4.36323C9.89822 4.48573 9.93451 4.62018 9.94175 4.75773C9.9485 4.92273 9.94175 5.05773 9.94175 5.16948C9.9448 5.29821 9.93652 5.42696 9.917 5.55423C9.89388 5.6849 9.85115 5.81133 9.79025 5.92923C9.72132 6.03885 9.62819 6.13121 9.518 6.19923C9.42547 6.25908 9.31589 6.287 9.206 6.27873M13.0138 3.34248H11.1912V6.94248H11.9622V5.51448H12.9372V4.84548H11.9622V4.01148H13.0122V3.34248" fill="white"/></svg>
                  <a >PDF File</a>
                </div>
            </div>
            <button>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.05831 5.44169C6.81414 5.19752 6.81414 4.80166 7.05831 4.55749L9.55831 2.05749C9.61581 1.99999 9.68509 1.95417 9.76176 1.9225C9.91426 1.85917 10.0868 1.85917 10.2393 1.9225C10.3159 1.95417 10.385 1.99999 10.4425 2.05749L12.9425 4.55749C13.1867 4.80166 13.1867 5.19752 12.9425 5.44169C12.8208 5.56335 12.6608 5.62499 12.5008 5.62499C12.3408 5.62499 12.1808 5.56419 12.0591 5.44169L10.6258 4.00833V13.3333C10.6258 13.6783 10.3458 13.9583 10.0008 13.9583C9.65581 13.9583 9.37581 13.6783 9.37581 13.3333V4.00914L7.9425 5.4425C7.6975 5.68583 7.30248 5.68585 7.05831 5.44169ZM15 7.70833C14.655 7.70833 14.375 7.98833 14.375 8.33333C14.375 8.67833 14.655 8.95833 15 8.95833C16.3142 8.95833 16.875 9.51916 16.875 10.8333V15C16.875 16.3142 16.3142 16.875 15 16.875H5C3.68583 16.875 3.125 16.3142 3.125 15V10.8333C3.125 9.51916 3.68583 8.95833 5 8.95833C5.345 8.95833 5.625 8.67833 5.625 8.33333C5.625 7.98833 5.345 7.70833 5 7.70833C2.985 7.70833 1.875 8.81833 1.875 10.8333V15C1.875 17.015 2.985 18.125 5 18.125H15C17.015 18.125 18.125 17.015 18.125 15V10.8333C18.125 8.81833 17.015 7.70833 15 7.70833Z" fill="white"/></svg>
            <span>Export</span></button>
            </div> 
          </div>
          {/* <div onClick={()=>setProceed(false)} className="proceed-bottom">
            <button>Done</button>
            <button className="button"> Edit</button>
          </div> */}
        </div>
    </div>
  )
}

export default ExportFramework
